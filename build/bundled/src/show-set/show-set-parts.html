<html><head><link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="../../bower_components/iron-data-table/iron-data-table.html">
<link rel="import" href="../../bower_components/iron-image/iron-image.html">
<link rel="import" href="../../bower_components/paper-toolbar/paper-toolbar.html">

<link rel="import" href="../../bower_components/paper-tooltip/paper-tooltip.html">
<link rel="import" href="../../bower_components/paper-material/paper-material.html">
<link rel="import" href="../../bower_components/paper-styles/paper-styles.html">

<link rel="import" href="../show-part/show-part.html">
<link rel="import" href="../colour-list/colour-list.html">

</head><body><dom-module id="show-set-parts">
  <template>
    <style include="shared-styles">:host{display:block;}</style>
    <colour-list id="colours"></colour-list>
    <iron-ajax id="theAjaxParts" url="https://rebrickable.com/api/get_set_parts" params="{{_params}}" handle-as="json" last-response="{{parts}}"></iron-ajax>
      <iron-data-table id="dataTable" items="[[parts.0.parts]]" on-selected-item-changed="_onSelectedChanged" selection-enabled="" style$="height: [[tableHeight]]px">
        <data-table-column align-right="" width="40px">
          <template>
            <iron-image src="[[item.part_img_url]]" preload="" style="width:40px; height:40px" sizing="contain"></iron-image>
          </template>
        </data-table-column>
        <data-table-column align-right="" width="20px" name="Qty">
          <template>[[item.qty]]</template>
        </data-table-column>
        <data-table-column name="Part ID" width="50px" filter-by="part_id">
          <template>[[item.part_id]]</template>
        </data-table-column>
        <data-table-column name="Name" flex="500" filter-by="part_name">
          <template>[[item.part_name]]</template>
        </data-table-column>
        <data-table-column name="Colour">
          <template>
            <div class="box" style="background-color: {{_getColour(item.rb_color_id)}}"></div>
          </template>
        </data-table-column>
      </iron-data-table>
    <show-part id="showPart"></show-part>

  </template>
  <script>!function(){"use strict";Polymer({is:"show-set-parts",behaviors:[Polymer.NeonAnimatableBehavior],properties:{setId:{type:String,observer:"_onHashChanged"},parts:{type:Array,notify:!0,value:[]},disablePopup:{type:Boolean,value:!1},_params:{type:Object},tableHeight:{type:Number,value:400}},_onHashChanged:function(){this.setId&&(this.set("parts",{}),this.set("_params",{key:"p4GLMlcPxJ",set:this.setId,format:"json"}),this.$.theAjaxParts.generateRequest())},_onSelectedChanged:function(e){!this.disablePopup&&e.detail&&e.detail.value&&this.$.showPart.show(e.detail.value.part_id),this.fire("selected-item-changed",e.detail)},_getColour:function(e){return this.$.colours.getColour(e)}})}();</script>
</dom-module>
</body></html>